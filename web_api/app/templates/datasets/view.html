{% extends "base.html" %}

{% block title %}{{ dataset.name }}{% endblock %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <a href="{{ url_for('datasets_web.list_datasets') }}" style="text-decoration: none; color: #666;">&larr; Back to Datasets</a>
</div>

<div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #eee;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h1 style="margin: 0;">{{ dataset.name }}</h1>
        <span style="
            padding: 0.5rem 1rem; 
            border-radius: 20px; 
            font-size: 0.9rem; 
            font-weight: 600;
            {% if dataset.status.value == 'available' %}background: #d4edda; color: #155724;
            {% elif dataset.status.value == 'uploading' %}background: #cce5ff; color: #004085;
            {% elif dataset.status.value == 'failed' %}background: #f8d7da; color: #721c24;
            {% else %}background: #e2e3e5; color: #383d41;{% endif %}
        ">
            {{ dataset.status.value|title }}
        </span>
    </div>

    <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.1rem; color: #444; margin-bottom: 0.5rem;">Description</h3>
        <p style="color: #666; line-height: 1.6;">
            {{ dataset.description or 'No description provided.' }}
        </p>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #eee;">
        <div>
            <div style="font-size: 0.85rem; color: #888; margin-bottom: 0.25rem;">Owner</div>
            <div style="font-weight: 500;">{{ dataset.owner.name }}</div>
        </div>
        <div>
            <div style="font-size: 0.85rem; color: #888; margin-bottom: 0.25rem;">Uploaded</div>
            <div style="font-weight: 500;">{{ dataset.uploaded_at.strftime('%Y-%m-%d %H:%M') }}</div>
        </div>
        <div>
            <div style="font-size: 0.85rem; color: #888; margin-bottom: 0.25rem;">Visibility</div>
            <div style="font-weight: 500;">{{ 'Public' if dataset.is_public else 'Private' }}</div>
        </div>
        {% if dataset.file_size_bytes %}
        <div>
            <div style="font-size: 0.85rem; color: #888; margin-bottom: 0.25rem;">Size</div>
            <div style="font-weight: 500;">{{ (dataset.file_size_bytes / 1024)|round(1) }} KB</div>
        </div>
        {% endif %}
    </div>

    {% if dataset.schema_info %}
    <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.1rem; color: #444; margin-bottom: 1rem;">Schema Information</h3>
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; overflow-x: auto;">
            <pre style="margin: 0; font-family: monospace; font-size: 0.9rem;">{{ dataset.schema_info | tojson(indent=2) }}</pre>
        </div>
    </div>
    {% endif %}

    <div style="display: flex; gap: 1rem;">
        {% if dataset.owner_id == current_user.id %}
        <form action="{{ url_for('datasets_web.delete_dataset', dataset_id=dataset.id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this dataset?');">
            <button type="submit" class="btn btn-danger" style="background: #dc3545; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">Delete Dataset</button>
        </form>
        {% endif %}
    </div>
</div>
{% endblock %}
